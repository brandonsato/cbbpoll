"""Remove Results, add is_provisional to Ballot

Revision ID: 5097734f84a4
Revises: a0c44ab3695
Create Date: 2014-10-02 04:04:53.838550

"""

# revision identifiers, used by Alembic.
revision = '5097734f84a4'
down_revision = 'a0c44ab3695'

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import mysql
from sqlalchemy.sql import table

def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('result')
    op.add_column('ballot', sa.Column('is_provisional', sa.Boolean(), nullable=True))
    ### end Alembic commands ###


def downgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('ballot', 'is_provisional')
    op.create_table('result',
    sa.Column('id', mysql.INTEGER(display_width=11), nullable=False),
    sa.Column('poll_id', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('team_id', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('score', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('onevotes', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['poll_id'], [u'poll.id'], name=u'result_ibfk_1', ondelete=u'CASCADE'),
    sa.ForeignKeyConstraint(['team_id'], [u'team.id'], name=u'result_ibfk_2'),
    sa.PrimaryKeyConstraint('id'),
    mysql_default_charset=u'utf8',
    mysql_engine=u'InnoDB'
    )
    ### end Alembic commands ###

    # need to re-add old results on downgrade
    result_table = table('result',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('poll_id', sa.Integer(), nullable=True),
    sa.Column('team_id', sa.Integer(), nullable=True),
    sa.Column('score', sa.Integer(), nullable=True),
    sa.Column('onevotes', sa.Integer(), nullable=True))

    op.bulk_insert(result_table,
        [
            {'id': 1 ,'poll_id': 1, 'team_id': 87 , 'score': 791, 'onevotes': 26},
            {'id': 2 ,'poll_id': 1, 'team_id': 344, 'score': 752, 'onevotes': 5},
            {'id': 3 ,'poll_id': 1, 'team_id': 11 , 'score': 712, 'onevotes': 1},
            {'id': 4 ,'poll_id': 1, 'team_id': 331, 'score': 664, 'onevotes': 0},
            {'id': 5 ,'poll_id': 1, 'team_id': 149, 'score': 663, 'onevotes': 0},
            {'id': 6 ,'poll_id': 1, 'team_id': 165, 'score': 614, 'onevotes': 0},
            {'id': 7 ,'poll_id': 1, 'team_id': 75 , 'score': 599, 'onevotes': 0},
            {'id': 8 ,'poll_id': 1, 'team_id': 330, 'score': 597, 'onevotes': 0},
            {'id': 9 ,'poll_id': 1, 'team_id': 317, 'score': 511, 'onevotes': 0},
            {'id': 10,'poll_id': 1, 'team_id': 132, 'score': 493, 'onevotes': 0},
            {'id': 11,'poll_id': 1, 'team_id': 125, 'score': 475, 'onevotes': 0},
            {'id': 12,'poll_id': 1, 'team_id': 244, 'score': 444, 'onevotes': 0},
            {'id': 13,'poll_id': 1, 'team_id': 273, 'score': 391, 'onevotes': 0},
            {'id': 14,'poll_id': 1, 'team_id': 166, 'score': 352, 'onevotes': 0},
            {'id': 15,'poll_id': 1, 'team_id': 64 , 'score': 332, 'onevotes': 0},
            {'id': 16,'poll_id': 1, 'team_id': 52 , 'score': 313, 'onevotes': 0},
            {'id': 17,'poll_id': 1, 'team_id': 61 , 'score': 277, 'onevotes': 0},
            {'id': 18,'poll_id': 1, 'team_id': 187, 'score': 262, 'onevotes': 0},
            {'id': 19,'poll_id': 1, 'team_id': 194, 'score': 239, 'onevotes': 0},
            {'id': 20,'poll_id': 1, 'team_id': 296, 'score': 192, 'onevotes': 0},
            {'id': 21,'poll_id': 1, 'team_id': 329, 'score': 140, 'onevotes': 0},
            {'id': 22,'poll_id': 1, 'team_id': 209, 'score': 98 , 'onevotes': 0},
            {'id': 23,'poll_id': 1, 'team_id': 207, 'score': 98 , 'onevotes': 0},
            {'id': 24,'poll_id': 1, 'team_id': 238, 'score': 76 , 'onevotes': 0},
            {'id': 25,'poll_id': 1, 'team_id': 306, 'score': 68 , 'onevotes': 0},
            {'id': 26,'poll_id': 1, 'team_id': 104, 'score': 61 , 'onevotes': 0},
            {'id': 27,'poll_id': 1, 'team_id': 136, 'score': 55 , 'onevotes': 0},
            {'id': 28,'poll_id': 1, 'team_id': 270, 'score': 25 , 'onevotes': 0},
            {'id': 29,'poll_id': 1, 'team_id': 21 , 'score': 24 , 'onevotes': 0},
            {'id': 30,'poll_id': 1, 'team_id': 219, 'score': 20 , 'onevotes': 0},
            {'id': 31,'poll_id': 1, 'team_id': 253, 'score': 13 , 'onevotes': 0},
            {'id': 32,'poll_id': 1, 'team_id': 237, 'score': 13 , 'onevotes': 0},
            {'id': 33,'poll_id': 1, 'team_id': 110, 'score': 11 , 'onevotes': 0},
            {'id': 34,'poll_id': 1, 'team_id': 210, 'score': 6  , 'onevotes': 0},
            {'id': 35,'poll_id': 1, 'team_id': 124, 'score': 4  , 'onevotes': 0},
            {'id': 36,'poll_id': 1, 'team_id': 98 , 'score': 3  , 'onevotes': 0},
            {'id': 37,'poll_id': 1, 'team_id': 213, 'score': 3  , 'onevotes': 0},
            {'id': 38,'poll_id': 1, 'team_id': 280, 'score': 2  , 'onevotes': 0},
            {'id': 39,'poll_id': 1, 'team_id': 133, 'score': 2  , 'onevotes': 0},
            {'id': 40,'poll_id': 1, 'team_id': 188, 'score': 1  , 'onevotes': 0},
            {'id': 41,'poll_id': 1, 'team_id': 276, 'score': 1  , 'onevotes': 0} 
        ]
    )
