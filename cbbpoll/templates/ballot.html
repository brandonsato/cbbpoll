{% extends "base.html" %}
{% block content %}
<h1>{{ballot}}<button class="reddit-table btn btn-info pull-right">Get Reddit Formatted Table</button></h1>
<hr>
{% if ballot.is_provisional %}<div class="alert alert-info" role="alert"><strong>FYI:</strong> This is a provisional ballot. It does not count towards this poll's results.</div>{% endif %}
<table class="ballot-view table table-striped">
	<tr>
		<th>Rank</th><th>Team</th><th>Reason</th>
	</tr>
	{% for vote in votes %}{% set team = teams.get(vote.team) %}
	<tr>
		<td>
			{{vote.rank}}
		</td>
		<td>
			<img src="{{team.png_url()}}" alt="{{team.full_name}} Logo"> {% if team.short_name-%}{{team.short_name}}{%-else-%}{{team.full_name}}{%-endif-%}
		</td>
		<td>
			{{ vote.reason }}
		</td>
	</tr>
	{% endfor %}
</table>
<div class="pop">
  <span>âœ–</span>
  <h3>Reddit Formatted Table</h3>
    <textarea readonly name="reddit-table" id="reddit-table">
Rank||Team|Reason
:--:|:--:|:---|:---
{% set prev_score = -1 -%}
{%- for vote in votes -%}
{%- set team = teams.get(vote.team) -%}
#{{vote.rank}}|{%- if team.flair -%}[](/{{team.flair}}){%-endif-%}|{%-if team.short_name-%}{{team.short_name}}{%-else-%}{{team.full_name}}{%-endif-%}|{{vote.reason}}
{% endfor %}
 </textarea>
</div>
{% endblock %}
{% block scripts %} 
{{super()}}
<script>
 $(document).ready(function () {
     $(".reddit-table").click(function () {
         $(".pop, .pop-bg").fadeIn(100);
         positionPopup();
     });

     $(".pop > span, .pop-bg").click(function () {
         $(".pop, .pop-bg").fadeOut(100);
     });
 });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.1.6/ZeroClipboard.min.js"></script>
<script>
var clientTarget = new ZeroClipboard( $("#copy-button"), {
    moviePath: "//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.1.6/ZeroClipboard.swf",
    debug: false
} );

clientTarget.on( "load", function(clientTarget)
{
    clientTarget.on( "complete", function(clientTarget, args) {
        clientTarget.setText( args.text );
    } );
} );
</script>
{% endblock %}
